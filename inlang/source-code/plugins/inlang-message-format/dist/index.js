var yn=Object.create;var We=Object.defineProperty;var In=Object.getOwnPropertyDescriptor;var gn=Object.getOwnPropertyNames;var On=Object.getPrototypeOf,bn=Object.prototype.hasOwnProperty;var mn=(u,t)=>()=>(t||u((t={exports:{}}).exports,t),t.exports);var Un=(u,t,s,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of gn(t))!bn.call(u,c)&&c!==s&&We(u,c,{get:()=>t[c],enumerable:!(a=In(t,c))||a.enumerable});return u};var Pn=(u,t,s)=>(s=u!=null?yn(On(u)):{},Un(t||!u||!u.__esModule?We(s,"default",{value:u,enumerable:!0}):s,u));var Ge=mn(i=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.Type=i.JsonType=i.JavaScriptTypeBuilder=i.JsonTypeBuilder=i.TypeBuilder=i.TypeBuilderError=i.TransformEncodeBuilder=i.TransformDecodeBuilder=i.TemplateLiteralDslParser=i.TemplateLiteralGenerator=i.TemplateLiteralGeneratorError=i.TemplateLiteralFinite=i.TemplateLiteralFiniteError=i.TemplateLiteralParser=i.TemplateLiteralParserError=i.TemplateLiteralResolver=i.TemplateLiteralPattern=i.TemplateLiteralPatternError=i.UnionResolver=i.KeyArrayResolver=i.KeyArrayResolverError=i.KeyResolver=i.ObjectMap=i.Intrinsic=i.IndexedAccessor=i.TypeClone=i.TypeExtends=i.TypeExtendsResult=i.TypeExtendsError=i.ExtendsUndefined=i.TypeGuard=i.TypeGuardUnknownTypeError=i.ValueGuard=i.FormatRegistry=i.TypeBoxError=i.TypeRegistry=i.PatternStringExact=i.PatternNumberExact=i.PatternBooleanExact=i.PatternString=i.PatternNumber=i.PatternBoolean=i.Kind=i.Hint=i.Optional=i.Readonly=i.Transform=void 0;i.Transform=Symbol.for("TypeBox.Transform");i.Readonly=Symbol.for("TypeBox.Readonly");i.Optional=Symbol.for("TypeBox.Optional");i.Hint=Symbol.for("TypeBox.Hint");i.Kind=Symbol.for("TypeBox.Kind");i.PatternBoolean="(true|false)";i.PatternNumber="(0|[1-9][0-9]*)";i.PatternString="(.*)";i.PatternBooleanExact=`^${i.PatternBoolean}$`;i.PatternNumberExact=`^${i.PatternNumber}$`;i.PatternStringExact=`^${i.PatternString}$`;var Be;(function(u){let t=new Map;function s(){return new Map(t)}u.Entries=s;function a(){return t.clear()}u.Clear=a;function c(I){return t.delete(I)}u.Delete=c;function T(I){return t.has(I)}u.Has=T;function l(I,m){t.set(I,m)}u.Set=l;function d(I){return t.get(I)}u.Get=d})(Be||(i.TypeRegistry=Be={}));var M=class extends Error{constructor(t){super(t)}};i.TypeBoxError=M;var Ye;(function(u){let t=new Map;function s(){return new Map(t)}u.Entries=s;function a(){return t.clear()}u.Clear=a;function c(I){return t.delete(I)}u.Delete=c;function T(I){return t.has(I)}u.Has=T;function l(I,m){t.set(I,m)}u.Set=l;function d(I){return t.get(I)}u.Get=d})(Ye||(i.FormatRegistry=Ye={}));var y;(function(u){function t(g){return Array.isArray(g)}u.IsArray=t;function s(g){return typeof g=="bigint"}u.IsBigInt=s;function a(g){return typeof g=="boolean"}u.IsBoolean=a;function c(g){return g instanceof globalThis.Date}u.IsDate=c;function T(g){return g===null}u.IsNull=T;function l(g){return typeof g=="number"}u.IsNumber=l;function d(g){return typeof g=="object"&&g!==null}u.IsObject=d;function I(g){return typeof g=="string"}u.IsString=I;function m(g){return g instanceof globalThis.Uint8Array}u.IsUint8Array=m;function O(g){return g===void 0}u.IsUndefined=O})(y||(i.ValueGuard=y={}));var ke=class extends M{};i.TypeGuardUnknownTypeError=ke;var o;(function(u){function t(r){try{return new RegExp(r),!0}catch{return!1}}function s(r){if(!y.IsString(r))return!1;for(let A=0;A<r.length;A++){let B=r.charCodeAt(A);if(B>=7&&B<=13||B===27||B===127)return!1}return!0}function a(r){return l(r)||C(r)}function c(r){return y.IsUndefined(r)||y.IsBigInt(r)}function T(r){return y.IsUndefined(r)||y.IsNumber(r)}function l(r){return y.IsUndefined(r)||y.IsBoolean(r)}function d(r){return y.IsUndefined(r)||y.IsString(r)}function I(r){return y.IsUndefined(r)||y.IsString(r)&&s(r)&&t(r)}function m(r){return y.IsUndefined(r)||y.IsString(r)&&s(r)}function O(r){return y.IsUndefined(r)||C(r)}function g(r){return R(r,"Any")&&d(r.$id)}u.TAny=g;function v(r){return R(r,"Array")&&r.type==="array"&&d(r.$id)&&C(r.items)&&T(r.minItems)&&T(r.maxItems)&&l(r.uniqueItems)&&O(r.contains)&&T(r.minContains)&&T(r.maxContains)}u.TArray=v;function f(r){return R(r,"AsyncIterator")&&r.type==="AsyncIterator"&&d(r.$id)&&C(r.items)}u.TAsyncIterator=f;function b(r){return R(r,"BigInt")&&r.type==="bigint"&&d(r.$id)&&c(r.exclusiveMaximum)&&c(r.exclusiveMinimum)&&c(r.maximum)&&c(r.minimum)&&c(r.multipleOf)}u.TBigInt=b;function P(r){return R(r,"Boolean")&&r.type==="boolean"&&d(r.$id)}u.TBoolean=P;function N(r){return R(r,"Constructor")&&r.type==="Constructor"&&d(r.$id)&&y.IsArray(r.parameters)&&r.parameters.every(A=>C(A))&&C(r.returns)}u.TConstructor=N;function L(r){return R(r,"Date")&&r.type==="Date"&&d(r.$id)&&T(r.exclusiveMaximumTimestamp)&&T(r.exclusiveMinimumTimestamp)&&T(r.maximumTimestamp)&&T(r.minimumTimestamp)&&T(r.multipleOfTimestamp)}u.TDate=L;function x(r){return R(r,"Function")&&r.type==="Function"&&d(r.$id)&&y.IsArray(r.parameters)&&r.parameters.every(A=>C(A))&&C(r.returns)}u.TFunction=x;function j(r){return R(r,"Integer")&&r.type==="integer"&&d(r.$id)&&T(r.exclusiveMaximum)&&T(r.exclusiveMinimum)&&T(r.maximum)&&T(r.minimum)&&T(r.multipleOf)}u.TInteger=j;function K(r){return R(r,"Intersect")&&!(y.IsString(r.type)&&r.type!=="object")&&y.IsArray(r.allOf)&&r.allOf.every(A=>C(A)&&!ie(A))&&d(r.type)&&(l(r.unevaluatedProperties)||O(r.unevaluatedProperties))&&d(r.$id)}u.TIntersect=K;function Te(r){return R(r,"Iterator")&&r.type==="Iterator"&&d(r.$id)&&C(r.items)}u.TIterator=Te;function R(r,A){return h(r)&&r[i.Kind]===A}u.TKindOf=R;function h(r){return y.IsObject(r)&&i.Kind in r&&y.IsString(r[i.Kind])}u.TKind=h;function ee(r){return J(r)&&y.IsString(r.const)}u.TLiteralString=ee;function le(r){return J(r)&&y.IsNumber(r.const)}u.TLiteralNumber=le;function je(r){return J(r)&&y.IsBoolean(r.const)}u.TLiteralBoolean=je;function J(r){return R(r,"Literal")&&d(r.$id)&&(y.IsBoolean(r.const)||y.IsNumber(r.const)||y.IsString(r.const))}u.TLiteral=J;function ce(r){return R(r,"Never")&&y.IsObject(r.not)&&Object.getOwnPropertyNames(r.not).length===0}u.TNever=ce;function $(r){return R(r,"Not")&&C(r.not)}u.TNot=$;function ne(r){return R(r,"Null")&&r.type==="null"&&d(r.$id)}u.TNull=ne;function te(r){return R(r,"Number")&&r.type==="number"&&d(r.$id)&&T(r.exclusiveMaximum)&&T(r.exclusiveMinimum)&&T(r.maximum)&&T(r.minimum)&&T(r.multipleOf)}u.TNumber=te;function H(r){return R(r,"Object")&&r.type==="object"&&d(r.$id)&&y.IsObject(r.properties)&&a(r.additionalProperties)&&T(r.minProperties)&&T(r.maxProperties)&&Object.entries(r.properties).every(([A,B])=>s(A)&&C(B))}u.TObject=H;function re(r){return R(r,"Promise")&&r.type==="Promise"&&d(r.$id)&&C(r.item)}u.TPromise=re;function pe(r){return R(r,"Record")&&r.type==="object"&&d(r.$id)&&a(r.additionalProperties)&&y.IsObject(r.patternProperties)&&(A=>{let B=Object.getOwnPropertyNames(A.patternProperties);return B.length===1&&t(B[0])&&y.IsObject(A.patternProperties)&&C(A.patternProperties[B[0]])})(r)}u.TRecord=pe;function Fe(r){return y.IsObject(r)&&i.Hint in r&&r[i.Hint]==="Recursive"}u.TRecursive=Fe;function de(r){return R(r,"Ref")&&d(r.$id)&&y.IsString(r.$ref)}u.TRef=de;function fe(r){return R(r,"String")&&r.type==="string"&&d(r.$id)&&T(r.minLength)&&T(r.maxLength)&&I(r.pattern)&&m(r.format)}u.TString=fe;function ye(r){return R(r,"Symbol")&&r.type==="symbol"&&d(r.$id)}u.TSymbol=ye;function V(r){return R(r,"TemplateLiteral")&&r.type==="string"&&y.IsString(r.pattern)&&r.pattern[0]==="^"&&r.pattern[r.pattern.length-1]==="$"}u.TTemplateLiteral=V;function Ie(r){return R(r,"This")&&d(r.$id)&&y.IsString(r.$ref)}u.TThis=Ie;function ie(r){return y.IsObject(r)&&i.Transform in r}u.TTransform=ie;function F(r){return R(r,"Tuple")&&r.type==="array"&&d(r.$id)&&y.IsNumber(r.minItems)&&y.IsNumber(r.maxItems)&&r.minItems===r.maxItems&&(y.IsUndefined(r.items)&&y.IsUndefined(r.additionalItems)&&r.minItems===0||y.IsArray(r.items)&&r.items.every(A=>C(A)))}u.TTuple=F;function ge(r){return R(r,"Undefined")&&r.type==="undefined"&&d(r.$id)}u.TUndefined=ge;function Ce(r){return q(r)&&r.anyOf.every(A=>ee(A)||le(A))}u.TUnionLiteral=Ce;function q(r){return R(r,"Union")&&d(r.$id)&&y.IsObject(r)&&y.IsArray(r.anyOf)&&r.anyOf.every(A=>C(A))}u.TUnion=q;function W(r){return R(r,"Uint8Array")&&r.type==="Uint8Array"&&d(r.$id)&&T(r.minByteLength)&&T(r.maxByteLength)}u.TUint8Array=W;function E(r){return R(r,"Unknown")&&d(r.$id)}u.TUnknown=E;function Oe(r){return R(r,"Unsafe")}u.TUnsafe=Oe;function oe(r){return R(r,"Void")&&r.type==="void"&&d(r.$id)}u.TVoid=oe;function $e(r){return y.IsObject(r)&&r[i.Readonly]==="Readonly"}u.TReadonly=$e;function Ke(r){return y.IsObject(r)&&r[i.Optional]==="Optional"}u.TOptional=Ke;function C(r){return y.IsObject(r)&&(g(r)||v(r)||P(r)||b(r)||f(r)||N(r)||L(r)||x(r)||j(r)||K(r)||Te(r)||J(r)||ce(r)||$(r)||ne(r)||te(r)||H(r)||re(r)||pe(r)||de(r)||fe(r)||ye(r)||V(r)||Ie(r)||F(r)||ge(r)||q(r)||W(r)||E(r)||Oe(r)||oe(r)||h(r)&&Be.Has(r[i.Kind]))}u.TSchema=C})(o||(i.TypeGuard=o={}));var Ze;(function(u){function t(s){return s[i.Kind]==="Intersect"?s.allOf.every(a=>t(a)):s[i.Kind]==="Union"?s.anyOf.some(a=>t(a)):s[i.Kind]==="Undefined"?!0:s[i.Kind]==="Not"?!t(s.not):!1}u.Check=t})(Ze||(i.ExtendsUndefined=Ze={}));var be=class extends M{};i.TypeExtendsError=be;var p;(function(u){u[u.Union=0]="Union",u[u.True=1]="True",u[u.False=2]="False"})(p||(i.TypeExtendsResult=p={}));var z;(function(u){function t(e){return e===p.False?e:p.True}function s(e){throw new be(e)}function a(e){return o.TNever(e)||o.TIntersect(e)||o.TUnion(e)||o.TUnknown(e)||o.TAny(e)}function c(e,n){return o.TNever(n)?R(e,n):o.TIntersect(n)?x(e,n):o.TUnion(n)?Ee(e,n):o.TUnknown(n)?He(e,n):o.TAny(n)?T(e,n):s("StructuralRight")}function T(e,n){return p.True}function l(e,n){return o.TIntersect(n)?x(e,n):o.TUnion(n)&&n.anyOf.some(S=>o.TAny(S)||o.TUnknown(S))?p.True:o.TUnion(n)?p.Union:o.TUnknown(n)||o.TAny(n)?p.True:p.Union}function d(e,n){return o.TUnknown(e)?p.False:o.TAny(e)?p.Union:o.TNever(e)?p.True:p.False}function I(e,n){return o.TObject(n)&&V(n)?p.True:a(n)?c(e,n):o.TArray(n)?t(w(e.items,n.items)):p.False}function m(e,n){return a(n)?c(e,n):o.TAsyncIterator(n)?t(w(e.items,n.items)):p.False}function O(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TBigInt(n)?p.True:p.False}function g(e,n){return o.TLiteral(e)&&y.IsBoolean(e.const)||o.TBoolean(e)?p.True:p.False}function v(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TBoolean(n)?p.True:p.False}function f(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TConstructor(n)?e.parameters.length>n.parameters.length?p.False:e.parameters.every((S,k)=>t(w(n.parameters[k],S))===p.True)?t(w(e.returns,n.returns)):p.False:p.False}function b(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TDate(n)?p.True:p.False}function P(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TFunction(n)?e.parameters.length>n.parameters.length?p.False:e.parameters.every((S,k)=>t(w(n.parameters[k],S))===p.True)?t(w(e.returns,n.returns)):p.False:p.False}function N(e,n){return o.TLiteral(e)&&y.IsNumber(e.const)||o.TNumber(e)||o.TInteger(e)?p.True:p.False}function L(e,n){return o.TInteger(n)||o.TNumber(n)?p.True:a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):p.False}function x(e,n){return n.allOf.every(S=>w(e,S)===p.True)?p.True:p.False}function j(e,n){return e.allOf.some(S=>w(S,n)===p.True)?p.True:p.False}function K(e,n){return a(n)?c(e,n):o.TIterator(n)?t(w(e.items,n.items)):p.False}function Te(e,n){return o.TLiteral(n)&&n.const===e.const?p.True:a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TString(n)?oe(e,n):o.TNumber(n)?J(e,n):o.TInteger(n)?N(e,n):o.TBoolean(n)?g(e,n):p.False}function R(e,n){return p.False}function h(e,n){return p.True}function ee(e){let[n,S]=[e,0];for(;o.TNot(n);)n=n.not,S+=1;return S%2===0?n:i.Type.Unknown()}function le(e,n){return o.TNot(e)?w(ee(e),n):o.TNot(n)?w(e,ee(n)):s("Invalid fallthrough for Not")}function je(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TNull(n)?p.True:p.False}function J(e,n){return o.TLiteralNumber(e)||o.TNumber(e)||o.TInteger(e)?p.True:p.False}function ce(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TInteger(n)||o.TNumber(n)?p.True:p.False}function $(e,n){return Object.getOwnPropertyNames(e.properties).length===n}function ne(e){return V(e)}function te(e){return $(e,0)||$(e,1)&&"description"in e.properties&&o.TUnion(e.properties.description)&&e.properties.description.anyOf.length===2&&(o.TString(e.properties.description.anyOf[0])&&o.TUndefined(e.properties.description.anyOf[1])||o.TString(e.properties.description.anyOf[1])&&o.TUndefined(e.properties.description.anyOf[0]))}function H(e){return $(e,0)}function re(e){return $(e,0)}function pe(e){return $(e,0)}function Fe(e){return $(e,0)}function de(e){return V(e)}function fe(e){let n=i.Type.Number();return $(e,0)||$(e,1)&&"length"in e.properties&&t(w(e.properties.length,n))===p.True}function ye(e){return $(e,0)}function V(e){let n=i.Type.Number();return $(e,0)||$(e,1)&&"length"in e.properties&&t(w(e.properties.length,n))===p.True}function Ie(e){let n=i.Type.Function([i.Type.Any()],i.Type.Any());return $(e,0)||$(e,1)&&"then"in e.properties&&t(w(e.properties.then,n))===p.True}function ie(e,n){return w(e,n)===p.False||o.TOptional(e)&&!o.TOptional(n)?p.False:p.True}function F(e,n){return o.TUnknown(e)?p.False:o.TAny(e)?p.Union:o.TNever(e)||o.TLiteralString(e)&&ne(n)||o.TLiteralNumber(e)&&H(n)||o.TLiteralBoolean(e)&&re(n)||o.TSymbol(e)&&te(n)||o.TBigInt(e)&&pe(n)||o.TString(e)&&ne(n)||o.TSymbol(e)&&te(n)||o.TNumber(e)&&H(n)||o.TInteger(e)&&H(n)||o.TBoolean(e)&&re(n)||o.TUint8Array(e)&&de(n)||o.TDate(e)&&Fe(n)||o.TConstructor(e)&&ye(n)||o.TFunction(e)&&fe(n)?p.True:o.TRecord(e)&&o.TString(q(e))?n[i.Hint]==="Record"?p.True:p.False:o.TRecord(e)&&o.TNumber(q(e))?$(n,0)?p.True:p.False:p.False}function ge(e,n){return a(n)?c(e,n):o.TRecord(n)?E(e,n):o.TObject(n)?(()=>{for(let S of Object.getOwnPropertyNames(n.properties)){if(!(S in e.properties)&&!o.TOptional(n.properties[S]))return p.False;if(o.TOptional(n.properties[S]))return p.True;if(ie(e.properties[S],n.properties[S])===p.False)return p.False}return p.True})():p.False}function Ce(e,n){return a(n)?c(e,n):o.TObject(n)&&Ie(n)?p.True:o.TPromise(n)?t(w(e.item,n.item)):p.False}function q(e){return i.PatternNumberExact in e.patternProperties?i.Type.Number():i.PatternStringExact in e.patternProperties?i.Type.String():s("Unknown record key pattern")}function W(e){return i.PatternNumberExact in e.patternProperties?e.patternProperties[i.PatternNumberExact]:i.PatternStringExact in e.patternProperties?e.patternProperties[i.PatternStringExact]:s("Unable to get record value schema")}function E(e,n){let[S,k]=[q(n),W(n)];return o.TLiteralString(e)&&o.TNumber(S)&&t(w(e,k))===p.True?p.True:o.TUint8Array(e)&&o.TNumber(S)||o.TString(e)&&o.TNumber(S)||o.TArray(e)&&o.TNumber(S)?w(e,k):o.TObject(e)?(()=>{for(let fn of Object.getOwnPropertyNames(e.properties))if(ie(k,e.properties[fn])===p.False)return p.False;return p.True})():p.False}function Oe(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?w(W(e),W(n)):p.False}function oe(e,n){return o.TLiteral(e)&&y.IsString(e.const)||o.TString(e)?p.True:p.False}function $e(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TString(n)?p.True:p.False}function Ke(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TSymbol(n)?p.True:p.False}function C(e,n){return o.TTemplateLiteral(e)?w(D.Resolve(e),n):o.TTemplateLiteral(n)?w(e,D.Resolve(n)):s("Invalid fallthrough for TemplateLiteral")}function r(e,n){return o.TArray(n)&&e.items!==void 0&&e.items.every(S=>w(S,n.items)===p.True)}function A(e,n){return o.TNever(e)?p.True:o.TUnknown(e)?p.False:o.TAny(e)?p.Union:p.False}function B(e,n){return a(n)?c(e,n):o.TObject(n)&&V(n)||o.TArray(n)&&r(e,n)?p.True:o.TTuple(n)?y.IsUndefined(e.items)&&!y.IsUndefined(n.items)||!y.IsUndefined(e.items)&&y.IsUndefined(n.items)?p.False:y.IsUndefined(e.items)&&!y.IsUndefined(n.items)||e.items.every((S,k)=>w(S,n.items[k])===p.True)?p.True:p.False:p.False}function un(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TUint8Array(n)?p.True:p.False}function an(e,n){return a(n)?c(e,n):o.TObject(n)?F(e,n):o.TRecord(n)?E(e,n):o.TVoid(n)?cn(e,n):o.TUndefined(n)?p.True:p.False}function Ee(e,n){return n.anyOf.some(S=>w(e,S)===p.True)?p.True:p.False}function Tn(e,n){return e.anyOf.every(S=>w(S,n)===p.True)?p.True:p.False}function He(e,n){return p.True}function ln(e,n){return o.TNever(n)?R(e,n):o.TIntersect(n)?x(e,n):o.TUnion(n)?Ee(e,n):o.TAny(n)?T(e,n):o.TString(n)?oe(e,n):o.TNumber(n)?J(e,n):o.TInteger(n)?N(e,n):o.TBoolean(n)?g(e,n):o.TArray(n)?d(e,n):o.TTuple(n)?A(e,n):o.TObject(n)?F(e,n):o.TUnknown(n)?p.True:p.False}function cn(e,n){return o.TUndefined(e)||o.TUndefined(e)?p.True:p.False}function pn(e,n){return o.TIntersect(n)?x(e,n):o.TUnion(n)?Ee(e,n):o.TUnknown(n)?He(e,n):o.TAny(n)?T(e,n):o.TObject(n)?F(e,n):o.TVoid(n)?p.True:p.False}function w(e,n){return o.TTemplateLiteral(e)||o.TTemplateLiteral(n)?C(e,n):o.TNot(e)||o.TNot(n)?le(e,n):o.TAny(e)?l(e,n):o.TArray(e)?I(e,n):o.TBigInt(e)?O(e,n):o.TBoolean(e)?v(e,n):o.TAsyncIterator(e)?m(e,n):o.TConstructor(e)?f(e,n):o.TDate(e)?b(e,n):o.TFunction(e)?P(e,n):o.TInteger(e)?L(e,n):o.TIntersect(e)?j(e,n):o.TIterator(e)?K(e,n):o.TLiteral(e)?Te(e,n):o.TNever(e)?h(e,n):o.TNull(e)?je(e,n):o.TNumber(e)?ce(e,n):o.TObject(e)?ge(e,n):o.TRecord(e)?Oe(e,n):o.TString(e)?$e(e,n):o.TSymbol(e)?Ke(e,n):o.TTuple(e)?B(e,n):o.TPromise(e)?Ce(e,n):o.TUint8Array(e)?un(e,n):o.TUndefined(e)?an(e,n):o.TUnion(e)?Tn(e,n):o.TUnknown(e)?ln(e,n):o.TVoid(e)?pn(e,n):s(`Unknown left type operand '${e[i.Kind]}'`)}function dn(e,n){return w(e,n)}u.Extends=dn})(z||(i.TypeExtends=z={}));var U;(function(u){function t(I){return I.map(m=>T(m))}function s(I){return new Date(I.getTime())}function a(I){return new Uint8Array(I)}function c(I){let m=Object.getOwnPropertyNames(I).reduce((g,v)=>({...g,[v]:T(I[v])}),{}),O=Object.getOwnPropertySymbols(I).reduce((g,v)=>({...g,[v]:T(I[v])}),{});return{...m,...O}}function T(I){return y.IsArray(I)?t(I):y.IsDate(I)?s(I):y.IsUint8Array(I)?a(I):y.IsObject(I)?c(I):I}function l(I){return I.map(m=>d(m))}u.Rest=l;function d(I,m={}){return{...T(I),...m}}u.Type=d})(U||(i.TypeClone=U={}));var Me;(function(u){function t(f){return f.map(b=>{let{[i.Optional]:P,...N}=U.Type(b);return N})}function s(f){return f.every(b=>o.TOptional(b))}function a(f){return f.some(b=>o.TOptional(b))}function c(f){return s(f.allOf)?i.Type.Optional(i.Type.Intersect(t(f.allOf))):f}function T(f){return a(f.anyOf)?i.Type.Optional(i.Type.Union(t(f.anyOf))):f}function l(f){return f[i.Kind]==="Intersect"?c(f):f[i.Kind]==="Union"?T(f):f}function d(f,b){let P=f.allOf.reduce((N,L)=>{let x=g(L,b);return x[i.Kind]==="Never"?N:[...N,x]},[]);return l(i.Type.Intersect(P))}function I(f,b){let P=f.anyOf.map(N=>g(N,b));return l(i.Type.Union(P))}function m(f,b){let P=f.properties[b];return y.IsUndefined(P)?i.Type.Never():i.Type.Union([P])}function O(f,b){let P=f.items;if(y.IsUndefined(P))return i.Type.Never();let N=P[b];return y.IsUndefined(N)?i.Type.Never():N}function g(f,b){return f[i.Kind]==="Intersect"?d(f,b):f[i.Kind]==="Union"?I(f,b):f[i.Kind]==="Object"?m(f,b):f[i.Kind]==="Tuple"?O(f,b):i.Type.Never()}function v(f,b,P={}){let N=b.map(L=>g(f,L.toString()));return l(i.Type.Union(N,P))}u.Resolve=v})(Me||(i.IndexedAccessor=Me={}));var _;(function(u){function t(O){let[g,v]=[O.slice(0,1),O.slice(1)];return`${g.toLowerCase()}${v}`}function s(O){let[g,v]=[O.slice(0,1),O.slice(1)];return`${g.toUpperCase()}${v}`}function a(O){return O.toUpperCase()}function c(O){return O.toLowerCase()}function T(O,g){let v=X.ParseExact(O.pattern);if(!Y.Check(v))return{...O,pattern:l(O.pattern,g)};let P=[...Z.Generate(v)].map(x=>i.Type.Literal(x)),N=d(P,g),L=i.Type.Union(N);return i.Type.TemplateLiteral([L])}function l(O,g){return typeof O=="string"?g==="Uncapitalize"?t(O):g==="Capitalize"?s(O):g==="Uppercase"?a(O):g==="Lowercase"?c(O):O:O.toString()}function d(O,g){if(O.length===0)return[];let[v,...f]=O;return[m(v,g),...d(f,g)]}function I(O,g){return o.TTemplateLiteral(O)?T(O,g):o.TUnion(O)?i.Type.Union(d(O.anyOf,g)):o.TLiteral(O)?i.Type.Literal(l(O.const,g)):O}function m(O,g){return I(O,g)}u.Map=m})(_||(i.Intrinsic=_={}));var Q;(function(u){function t(l,d){return i.Type.Intersect(l.allOf.map(I=>c(I,d)),{...l})}function s(l,d){return i.Type.Union(l.anyOf.map(I=>c(I,d)),{...l})}function a(l,d){return d(l)}function c(l,d){return l[i.Kind]==="Intersect"?t(l,d):l[i.Kind]==="Union"?s(l,d):l[i.Kind]==="Object"?a(l,d):l}function T(l,d,I){return{...c(U.Type(l),d),...I}}u.Map=T})(Q||(i.ObjectMap=Q={}));var me;(function(u){function t(m){return m[0]==="^"&&m[m.length-1]==="$"?m.slice(1,m.length-1):m}function s(m,O){return m.allOf.reduce((g,v)=>[...g,...l(v,O)],[])}function a(m,O){let g=m.anyOf.map(v=>l(v,O));return[...g.reduce((v,f)=>f.map(b=>g.every(P=>P.includes(b))?v.add(b):v)[0],new Set)]}function c(m,O){return Object.getOwnPropertyNames(m.properties)}function T(m,O){return O.includePatterns?Object.getOwnPropertyNames(m.patternProperties):[]}function l(m,O){return o.TIntersect(m)?s(m,O):o.TUnion(m)?a(m,O):o.TObject(m)?c(m,O):o.TRecord(m)?T(m,O):[]}function d(m,O){return[...new Set(l(m,O))]}u.ResolveKeys=d;function I(m){return`^(${d(m,{includePatterns:!0}).map(v=>`(${t(v)})`).join("|")})$`}u.ResolvePattern=I})(me||(i.KeyResolver=me={}));var Ue=class extends M{};i.KeyArrayResolverError=Ue;var se;(function(u){function t(s){return Array.isArray(s)?s:o.TUnionLiteral(s)?s.anyOf.map(a=>a.const.toString()):o.TLiteral(s)?[s.const]:o.TTemplateLiteral(s)?(()=>{let a=X.ParseExact(s.pattern);if(!Y.Check(a))throw new Ue("Cannot resolve keys from infinite template expression");return[...Z.Generate(a)]})():[]}u.Resolve=t})(se||(i.KeyArrayResolver=se={}));var De;(function(u){function*t(a){for(let c of a.anyOf)c[i.Kind]==="Union"?yield*t(c):yield c}function s(a){return i.Type.Union([...t(a)],{...a})}u.Resolve=s})(De||(i.UnionResolver=De={}));var Pe=class extends M{};i.TemplateLiteralPatternError=Pe;var Re;(function(u){function t(T){throw new Pe(T)}function s(T){return T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(T,l){return o.TTemplateLiteral(T)?T.pattern.slice(1,T.pattern.length-1):o.TUnion(T)?`(${T.anyOf.map(d=>a(d,l)).join("|")})`:o.TNumber(T)?`${l}${i.PatternNumber}`:o.TInteger(T)?`${l}${i.PatternNumber}`:o.TBigInt(T)?`${l}${i.PatternNumber}`:o.TString(T)?`${l}${i.PatternString}`:o.TLiteral(T)?`${l}${s(T.const.toString())}`:o.TBoolean(T)?`${l}${i.PatternBoolean}`:t(`Unexpected Kind '${T[i.Kind]}'`)}function c(T){return`^${T.map(l=>a(l,"")).join("")}$`}u.Create=c})(Re||(i.TemplateLiteralPattern=Re={}));var D;(function(u){function t(s){let a=X.ParseExact(s.pattern);if(!Y.Check(a))return i.Type.String();let c=[...Z.Generate(a)].map(T=>i.Type.Literal(T));return i.Type.Union(c)}u.Resolve=t})(D||(i.TemplateLiteralResolver=D={}));var ue=class extends M{};i.TemplateLiteralParserError=ue;var X;(function(u){function t(f,b,P){return f[b]===P&&f.charCodeAt(b-1)!==92}function s(f,b){return t(f,b,"(")}function a(f,b){return t(f,b,")")}function c(f,b){return t(f,b,"|")}function T(f){if(!(s(f,0)&&a(f,f.length-1)))return!1;let b=0;for(let P=0;P<f.length;P++)if(s(f,P)&&(b+=1),a(f,P)&&(b-=1),b===0&&P!==f.length-1)return!1;return!0}function l(f){return f.slice(1,f.length-1)}function d(f){let b=0;for(let P=0;P<f.length;P++)if(s(f,P)&&(b+=1),a(f,P)&&(b-=1),c(f,P)&&b===0)return!0;return!1}function I(f){for(let b=0;b<f.length;b++)if(s(f,b))return!0;return!1}function m(f){let[b,P]=[0,0],N=[];for(let x=0;x<f.length;x++)if(s(f,x)&&(b+=1),a(f,x)&&(b-=1),c(f,x)&&b===0){let j=f.slice(P,x);j.length>0&&N.push(g(j)),P=x+1}let L=f.slice(P);return L.length>0&&N.push(g(L)),N.length===0?{type:"const",const:""}:N.length===1?N[0]:{type:"or",expr:N}}function O(f){function b(L,x){if(!s(L,x))throw new ue("TemplateLiteralParser: Index must point to open parens");let j=0;for(let K=x;K<L.length;K++)if(s(L,K)&&(j+=1),a(L,K)&&(j-=1),j===0)return[x,K];throw new ue("TemplateLiteralParser: Unclosed group parens in expression")}function P(L,x){for(let j=x;j<L.length;j++)if(s(L,j))return[x,j];return[x,L.length]}let N=[];for(let L=0;L<f.length;L++)if(s(f,L)){let[x,j]=b(f,L),K=f.slice(x,j+1);N.push(g(K)),L=j}else{let[x,j]=P(f,L),K=f.slice(x,j);K.length>0&&N.push(g(K)),L=j-1}return N.length===0?{type:"const",const:""}:N.length===1?N[0]:{type:"and",expr:N}}function g(f){return T(f)?g(l(f)):d(f)?m(f):I(f)?O(f):{type:"const",const:f}}u.Parse=g;function v(f){return g(f.slice(1,f.length-1))}u.ParseExact=v})(X||(i.TemplateLiteralParser=X={}));var Ne=class extends M{};i.TemplateLiteralFiniteError=Ne;var Y;(function(u){function t(l){throw new Ne(l)}function s(l){return l.type==="or"&&l.expr.length===2&&l.expr[0].type==="const"&&l.expr[0].const==="0"&&l.expr[1].type==="const"&&l.expr[1].const==="[1-9][0-9]*"}function a(l){return l.type==="or"&&l.expr.length===2&&l.expr[0].type==="const"&&l.expr[0].const==="true"&&l.expr[1].type==="const"&&l.expr[1].const==="false"}function c(l){return l.type==="const"&&l.const===".*"}function T(l){return a(l)?!0:s(l)||c(l)?!1:l.type==="and"?l.expr.every(d=>T(d)):l.type==="or"?l.expr.every(d=>T(d)):l.type==="const"?!0:t("Unknown expression type")}u.Check=T})(Y||(i.TemplateLiteralFinite=Y={}));var ve=class extends M{};i.TemplateLiteralGeneratorError=ve;var Z;(function(u){function*t(l){if(l.length===1)return yield*l[0];for(let d of l[0])for(let I of t(l.slice(1)))yield`${d}${I}`}function*s(l){return yield*t(l.expr.map(d=>[...T(d)]))}function*a(l){for(let d of l.expr)yield*T(d)}function*c(l){return yield l.const}function*T(l){return l.type==="and"?yield*s(l):l.type==="or"?yield*a(l):l.type==="const"?yield*c(l):(()=>{throw new ve("Unknown expression")})()}u.Generate=T})(Z||(i.TemplateLiteralGenerator=Z={}));var Je;(function(u){function*t(T){let l=T.trim().replace(/"|'/g,"");return l==="boolean"?yield i.Type.Boolean():l==="number"?yield i.Type.Number():l==="bigint"?yield i.Type.BigInt():l==="string"?yield i.Type.String():yield(()=>{let d=l.split("|").map(I=>i.Type.Literal(I.trim()));return d.length===0?i.Type.Never():d.length===1?d[0]:i.Type.Union(d)})()}function*s(T){if(T[1]!=="{"){let l=i.Type.Literal("$"),d=a(T.slice(1));return yield*[l,...d]}for(let l=2;l<T.length;l++)if(T[l]==="}"){let d=t(T.slice(2,l)),I=a(T.slice(l+1));return yield*[...d,...I]}yield i.Type.Literal(T)}function*a(T){for(let l=0;l<T.length;l++)if(T[l]==="$"){let d=i.Type.Literal(T.slice(0,l)),I=s(T.slice(l));return yield*[d,...I]}yield i.Type.Literal(T)}function c(T){return[...a(T)]}u.Parse=c})(Je||(i.TemplateLiteralDslParser=Je={}));var xe=class{constructor(t){this.schema=t}Decode(t){return new Se(this.schema,t)}};i.TransformDecodeBuilder=xe;var Se=class{constructor(t,s){this.schema=t,this.decode=s}Encode(t){let s=U.Type(this.schema);return o.TTransform(s)?(()=>{let T={Encode:l=>s[i.Transform].Encode(t(l)),Decode:l=>this.decode(s[i.Transform].Decode(l))};return{...s,[i.Transform]:T}})():(()=>{let a={Decode:this.decode,Encode:t};return{...s,[i.Transform]:a}})()}};i.TransformEncodeBuilder=Se;var Rn=0,Le=class extends M{};i.TypeBuilderError=Le;var we=class{Create(t){return t}Throw(t){throw new Le(t)}Discard(t,s){return s.reduce((a,c)=>{let{[c]:T,...l}=a;return l},t)}Strict(t){return JSON.parse(JSON.stringify(t))}};i.TypeBuilder=we;var ae=class extends we{ReadonlyOptional(t){return this.Readonly(this.Optional(t))}Readonly(t){return{...U.Type(t),[i.Readonly]:"Readonly"}}Optional(t){return{...U.Type(t),[i.Optional]:"Optional"}}Any(t={}){return this.Create({...t,[i.Kind]:"Any"})}Array(t,s={}){return this.Create({...s,[i.Kind]:"Array",type:"array",items:U.Type(t)})}Boolean(t={}){return this.Create({...t,[i.Kind]:"Boolean",type:"boolean"})}Capitalize(t,s={}){return{..._.Map(U.Type(t),"Capitalize"),...s}}Composite(t,s){let a=i.Type.Intersect(t,{}),T=me.ResolveKeys(a,{includePatterns:!1}).reduce((l,d)=>({...l,[d]:i.Type.Index(a,[d])}),{});return i.Type.Object(T,s)}Enum(t,s={}){if(y.IsUndefined(t))return this.Throw("Enum undefined or empty");let a=Object.getOwnPropertyNames(t).filter(l=>isNaN(l)).map(l=>t[l]),T=[...new Set(a)].map(l=>i.Type.Literal(l));return this.Union(T,{...s,[i.Hint]:"Enum"})}Extends(t,s,a,c,T={}){switch(z.Extends(t,s)){case p.Union:return this.Union([U.Type(a,T),U.Type(c,T)]);case p.True:return U.Type(a,T);case p.False:return U.Type(c,T)}}Exclude(t,s,a={}){return o.TTemplateLiteral(t)?this.Exclude(D.Resolve(t),s,a):o.TTemplateLiteral(s)?this.Exclude(t,D.Resolve(s),a):o.TUnion(t)?(()=>{let c=t.anyOf.filter(T=>z.Extends(T,s)===p.False);return c.length===1?U.Type(c[0],a):this.Union(c,a)})():z.Extends(t,s)!==p.False?this.Never(a):U.Type(t,a)}Extract(t,s,a={}){return o.TTemplateLiteral(t)?this.Extract(D.Resolve(t),s,a):o.TTemplateLiteral(s)?this.Extract(t,D.Resolve(s),a):o.TUnion(t)?(()=>{let c=t.anyOf.filter(T=>z.Extends(T,s)!==p.False);return c.length===1?U.Type(c[0],a):this.Union(c,a)})():z.Extends(t,s)!==p.False?U.Type(t,a):this.Never(a)}Index(t,s,a={}){return o.TArray(t)&&o.TNumber(s)?U.Type(t.items,a):o.TTuple(t)&&o.TNumber(s)?(()=>{let T=(y.IsUndefined(t.items)?[]:t.items).map(l=>U.Type(l));return this.Union(T,a)})():(()=>{let c=se.Resolve(s),T=U.Type(t);return Me.Resolve(T,c,a)})()}Integer(t={}){return this.Create({...t,[i.Kind]:"Integer",type:"integer"})}Intersect(t,s={}){if(t.length===0)return i.Type.Never();if(t.length===1)return U.Type(t[0],s);t.some(l=>o.TTransform(l))&&this.Throw("Cannot intersect transform types");let a=t.every(l=>o.TObject(l)),c=U.Rest(t),T=o.TSchema(s.unevaluatedProperties)?{unevaluatedProperties:U.Type(s.unevaluatedProperties)}:{};return s.unevaluatedProperties===!1||o.TSchema(s.unevaluatedProperties)||a?this.Create({...s,...T,[i.Kind]:"Intersect",type:"object",allOf:c}):this.Create({...s,...T,[i.Kind]:"Intersect",allOf:c})}KeyOf(t,s={}){return o.TRecord(t)?(()=>{let a=Object.getOwnPropertyNames(t.patternProperties)[0];return a===i.PatternNumberExact?this.Number(s):a===i.PatternStringExact?this.String(s):this.Throw("Unable to resolve key type from Record key pattern")})():o.TTuple(t)?(()=>{let c=(y.IsUndefined(t.items)?[]:t.items).map((T,l)=>i.Type.Literal(l.toString()));return this.Union(c,s)})():o.TArray(t)?this.Number(s):(()=>{let a=me.ResolveKeys(t,{includePatterns:!1});if(a.length===0)return this.Never(s);let c=a.map(T=>this.Literal(T));return this.Union(c,s)})()}Literal(t,s={}){return this.Create({...s,[i.Kind]:"Literal",const:t,type:typeof t})}Lowercase(t,s={}){return{..._.Map(U.Type(t),"Lowercase"),...s}}Never(t={}){return this.Create({...t,[i.Kind]:"Never",not:{}})}Not(t,s){return this.Create({...s,[i.Kind]:"Not",not:U.Type(t)})}Null(t={}){return this.Create({...t,[i.Kind]:"Null",type:"null"})}Number(t={}){return this.Create({...t,[i.Kind]:"Number",type:"number"})}Object(t,s={}){let a=Object.getOwnPropertyNames(t),c=a.filter(I=>o.TOptional(t[I])),T=a.filter(I=>!c.includes(I)),l=o.TSchema(s.additionalProperties)?{additionalProperties:U.Type(s.additionalProperties)}:{},d=a.reduce((I,m)=>({...I,[m]:U.Type(t[m])}),{});return T.length>0?this.Create({...s,...l,[i.Kind]:"Object",type:"object",properties:d,required:T}):this.Create({...s,...l,[i.Kind]:"Object",type:"object",properties:d})}Omit(t,s,a={}){let c=se.Resolve(s);return Q.Map(this.Discard(U.Type(t),["$id",i.Transform]),T=>{y.IsArray(T.required)&&(T.required=T.required.filter(l=>!c.includes(l)),T.required.length===0&&delete T.required);for(let l of Object.getOwnPropertyNames(T.properties))c.includes(l)&&delete T.properties[l];return this.Create(T)},a)}Partial(t,s={}){return Q.Map(this.Discard(U.Type(t),["$id",i.Transform]),a=>{let c=Object.getOwnPropertyNames(a.properties).reduce((T,l)=>({...T,[l]:this.Optional(a.properties[l])}),{});return this.Object(c,this.Discard(a,["required"]))},s)}Pick(t,s,a={}){let c=se.Resolve(s);return Q.Map(this.Discard(U.Type(t),["$id",i.Transform]),T=>{y.IsArray(T.required)&&(T.required=T.required.filter(l=>c.includes(l)),T.required.length===0&&delete T.required);for(let l of Object.getOwnPropertyNames(T.properties))c.includes(l)||delete T.properties[l];return this.Create(T)},a)}Record(t,s,a={}){return o.TTemplateLiteral(t)?(()=>{let c=X.ParseExact(t.pattern);return Y.Check(c)?this.Object([...Z.Generate(c)].reduce((T,l)=>({...T,[l]:U.Type(s)}),{}),a):this.Create({...a,[i.Kind]:"Record",type:"object",patternProperties:{[t.pattern]:U.Type(s)}})})():o.TUnion(t)?(()=>{let c=De.Resolve(t);if(o.TUnionLiteral(c)){let T=c.anyOf.reduce((l,d)=>({...l,[d.const]:U.Type(s)}),{});return this.Object(T,{...a,[i.Hint]:"Record"})}else this.Throw("Record key of type union contains non-literal types")})():o.TLiteral(t)?y.IsString(t.const)||y.IsNumber(t.const)?this.Object({[t.const]:U.Type(s)},a):this.Throw("Record key of type literal is not of type string or number"):o.TInteger(t)||o.TNumber(t)?this.Create({...a,[i.Kind]:"Record",type:"object",patternProperties:{[i.PatternNumberExact]:U.Type(s)}}):o.TString(t)?(()=>{let c=y.IsUndefined(t.pattern)?i.PatternStringExact:t.pattern;return this.Create({...a,[i.Kind]:"Record",type:"object",patternProperties:{[c]:U.Type(s)}})})():this.Never()}Recursive(t,s={}){y.IsUndefined(s.$id)&&(s.$id=`T${Rn++}`);let a=t({[i.Kind]:"This",$ref:`${s.$id}`});return a.$id=s.$id,this.Create({...s,[i.Hint]:"Recursive",...a})}Ref(t,s={}){return y.IsString(t)?this.Create({...s,[i.Kind]:"Ref",$ref:t}):(y.IsUndefined(t.$id)&&this.Throw("Reference target type must specify an $id"),this.Create({...s,[i.Kind]:"Ref",$ref:t.$id}))}Required(t,s={}){return Q.Map(this.Discard(U.Type(t),["$id",i.Transform]),a=>{let c=Object.getOwnPropertyNames(a.properties).reduce((T,l)=>({...T,[l]:this.Discard(a.properties[l],[i.Optional])}),{});return this.Object(c,a)},s)}Rest(t){return o.TTuple(t)&&!y.IsUndefined(t.items)?U.Rest(t.items):o.TIntersect(t)?U.Rest(t.allOf):o.TUnion(t)?U.Rest(t.anyOf):[]}String(t={}){return this.Create({...t,[i.Kind]:"String",type:"string"})}TemplateLiteral(t,s={}){let a=y.IsString(t)?Re.Create(Je.Parse(t)):Re.Create(t);return this.Create({...s,[i.Kind]:"TemplateLiteral",type:"string",pattern:a})}Transform(t){return new xe(t)}Tuple(t,s={}){let[a,c,T]=[!1,t.length,t.length],l=U.Rest(t),d=t.length>0?{...s,[i.Kind]:"Tuple",type:"array",items:l,additionalItems:a,minItems:c,maxItems:T}:{...s,[i.Kind]:"Tuple",type:"array",minItems:c,maxItems:T};return this.Create(d)}Uncapitalize(t,s={}){return{..._.Map(U.Type(t),"Uncapitalize"),...s}}Union(t,s={}){return o.TTemplateLiteral(t)?D.Resolve(t):(()=>{let a=t;if(a.length===0)return this.Never(s);if(a.length===1)return this.Create(U.Type(a[0],s));let c=U.Rest(a);return this.Create({...s,[i.Kind]:"Union",anyOf:c})})()}Unknown(t={}){return this.Create({...t,[i.Kind]:"Unknown"})}Unsafe(t={}){return this.Create({...t,[i.Kind]:t[i.Kind]||"Unsafe"})}Uppercase(t,s={}){return{..._.Map(U.Type(t),"Uppercase"),...s}}};i.JsonTypeBuilder=ae;var Ae=class extends ae{AsyncIterator(t,s={}){return this.Create({...s,[i.Kind]:"AsyncIterator",type:"AsyncIterator",items:U.Type(t)})}Awaited(t,s={}){let a=c=>c.length>0?(()=>{let[T,...l]=c;return[this.Awaited(T),...a(l)]})():c;return o.TIntersect(t)?i.Type.Intersect(a(t.allOf)):o.TUnion(t)?i.Type.Union(a(t.anyOf)):o.TPromise(t)?this.Awaited(t.item):U.Type(t,s)}BigInt(t={}){return this.Create({...t,[i.Kind]:"BigInt",type:"bigint"})}ConstructorParameters(t,s={}){return this.Tuple([...t.parameters],{...s})}Constructor(t,s,a){let[c,T]=[U.Rest(t),U.Type(s)];return this.Create({...a,[i.Kind]:"Constructor",type:"Constructor",parameters:c,returns:T})}Date(t={}){return this.Create({...t,[i.Kind]:"Date",type:"Date"})}Function(t,s,a){let[c,T]=[U.Rest(t),U.Type(s)];return this.Create({...a,[i.Kind]:"Function",type:"Function",parameters:c,returns:T})}InstanceType(t,s={}){return U.Type(t.returns,s)}Iterator(t,s={}){return this.Create({...s,[i.Kind]:"Iterator",type:"Iterator",items:U.Type(t)})}Parameters(t,s={}){return this.Tuple(t.parameters,{...s})}Promise(t,s={}){return this.Create({...s,[i.Kind]:"Promise",type:"Promise",item:U.Type(t)})}RegExp(t,s={}){let a=y.IsString(t)?t:t.source;return this.Create({...s,[i.Kind]:"String",type:"string",pattern:a})}RegEx(t,s={}){return this.RegExp(t,s)}ReturnType(t,s={}){return U.Type(t.returns,s)}Symbol(t){return this.Create({...t,[i.Kind]:"Symbol",type:"symbol"})}Undefined(t={}){return this.Create({...t,[i.Kind]:"Undefined",type:"undefined"})}Uint8Array(t={}){return this.Create({...t,[i.Kind]:"Uint8Array",type:"Uint8Array"})}Void(t={}){return this.Create({...t,[i.Kind]:"Void",type:"void"})}};i.JavaScriptTypeBuilder=Ae;i.JsonType=new ae;i.Type=new Ae});var Qe={en:"inlang message format"},Xe={en:"The simplest storage plugin for inlang."};var G=Pn(Ge(),1),he=G.Type.Object({filePath:G.Type.Optional(G.Type.String({description:"DEPRECATED. Use filePathPattern instead.",deprecated:!0})),pathPatterns:G.Type.Array(G.Type.String({pattern:".*\\{languageTag\\}.*\\.json$",examples:["./messages/{languageTag}.json","./i18n/{languageTag}.json"],description:"The path to the JSON file where the messages are stored."}))});var Nn=u=>{let t=en(u,0);if(t===void 0||!xn(u[t]))return;let s=en(u,t+1);if(s!==void 0)return Sn(u,t,s)},nn=Nn,en=(u,t)=>{for(let s=t;s<u.length;s+=1){let a=u[s];if(!vn(a))return s}},vn=u=>u===" "||u==="	"||u===`
`||u==="\r",xn=u=>u==="{"||u==="[",Sn=(u,t,s)=>{let a;for(let c=s-1;c>t;c-=1){let T=u[c];if(T==="\r")return;if(T===`
`)return Ln(a);if(a===void 0)a=T;else if(a[0]===T)a+=T;else return}},Ln=u=>u===void 0?0:u[0]===" "?u.length:u;var Ve=u=>{let t=u.endsWith(`
`),s=nn(u);return(a,c)=>JSON.stringify(a,c,s)+(t?`
`:"")};var tn=u=>u.map(t=>{switch(t.type){case"Text":return t.value;case"VariableReference":return`{${t.name}}`}}).join("");var rn=u=>{let t={};for(let s of u.variants){if(t[s.languageTag]!==void 0)throw new Error(`The message "${u.id}" has multiple variants for the language tag "${s.languageTag}". The inlang-message-format plugin does not support multiple variants for the same language tag at the moment.`);t[s.languageTag]=tn(s.pattern)}return t};var on=u=>{let t=/\{([^}]+)\}/g,s,a=0,c=[];for(;(s=t.exec(u))!==null;){let l=s[1],d=u.slice(a,s.index);d.length>0&&c.push({type:"Text",value:d}),c.push({type:"VariableReference",name:l}),a=s.index+s[0].length}let T=u.slice(Math.max(0,a));return T.length>0&&c.push({type:"Text",value:T}),c};var qe=u=>({id:u.key,selectors:[],variants:[{languageTag:u.languageTag,match:[],pattern:on(u.value)}]});var wn="plugin.inlang.messageFormat",sn={},ze={id:wn,displayName:Qe,description:Xe,settingsSchema:he,loadMessages:async({settings:u,nodeishFs:t})=>{await Fn({settings:u,nodeishFs:t});let s={};for(let a of u.languageTags)try{let c=u["plugin.inlang.messageFormat"].pathPatterns[0];if(!c)continue;let T=await t.readFile(c.replace("{languageTag}",a),{encoding:"utf-8"});sn[a]=Ve(T);let l=JSON.parse(T);for(let d in l)d!=="$schema"&&(s[d]?s[d].variants=[...s[d].variants,...qe({key:d,value:l[d],languageTag:a}).variants]:s[d]=qe({key:d,value:l[d],languageTag:a}))}catch{}return Object.values(s)},saveMessages:async({settings:u,nodeishFs:t,messages:s})=>{let a={};for(let c of s){let T=rn(c);for(let[l,d]of Object.entries(T))a[l]===void 0&&(a[l]={}),a[l][c.id]=d}for(let[c,T]of Object.entries(a)){let l=u["plugin.inlang.messageFormat"].pathPatterns[0];if(!l)continue;let d=l.replace("{languageTag}",c);await An({path:d,nodeishFs:t}),await t.writeFile(l.replace("{languageTag}",c),(sn[c]??(I=>JSON.stringify(I,void 0,"	")))({$schema:"https://inlang.com/schema/inlang-message-format",...T}))}}},An=async u=>{try{await u.nodeishFs.mkdir(jn(u.path),{recursive:!0})}catch{}};function jn(u){if(u.length===0)return".";let t=u.charCodeAt(0),s=t===47,a=-1,c=!0;for(let T=u.length-1;T>=1;--T)if(t=u.charCodeAt(T),t===47){if(!c){a=T;break}}else c=!1;return a===-1?s?"/":".":s&&a===1?"//":u.slice(0,a)}var Fn=async u=>{if(u.settings["plugin.inlang.messageFormat"].filePath!=null)try{let t=await u.nodeishFs.readFile(u.settings["plugin.inlang.messageFormat"].filePath,{encoding:"utf-8"});await ze.saveMessages?.({messages:JSON.parse(t).data,nodeishFs:u.nodeishFs,settings:u.settings}),console.log("Migration to v2 of the inlang-message-format plugin was successful. Please delete the old messages.json file and the filePath property in the settings file of the project.")}catch{}};var nt=ze;export{nt as default};
